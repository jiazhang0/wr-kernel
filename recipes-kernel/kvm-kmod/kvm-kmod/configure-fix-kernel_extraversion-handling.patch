From 466d06bbca1eda75d10bb37b54d0aaa70e909c21 Mon Sep 17 00:00:00 2001
From: Mark Asselstine <mark.asselstine@windriver.com>
Date: Tue, 11 Sep 2012 10:45:15 -0400
Subject: [PATCH] configure: fix kernel_extraversion handling

Skip parsing of kernel_extraversion since it does not work with our
kernel version string and does not have any uses with the 3.4 kernel
anyways.

Signed-off-by: Mark Asselstine <mark.asselstine@windriver.com>
---
 configure |    7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/configure b/configure
index 4c5a63d..b1b4a6d 100755
--- a/configure
+++ b/configure
@@ -133,7 +133,12 @@ if [ ! -n "$force_build" ]; then
 	fi
 fi
 
-kernel_extraversion=`echo $kernel_version_str | sed 's/[0-9]*\.[0-9]*\.[0-9]*\.\([0-9]*\)*.*/\1/'`
+# This logic fails with WR Linux kernel version strings, ex. 3.4.9-WR5.0.0.0_standard
+# We could correct the logic but since no uses of kernel_extraversion affect us
+# we can simply set this to zero.
+#kernel_extraversion=`echo $kernel_version_str | sed 's/[0-9]*\.[0-9]*\.[0-9]*\.\([0-9]*\)*.*/\1/'`
+kernel_extraversion=0
+
 if [ ! -n $kernel_extraversion ] || [ $kernel_extraversion = $kernel_version_str ]; then
 	kernel_extraversion=0
 fi
-- 
1.7.9.5

